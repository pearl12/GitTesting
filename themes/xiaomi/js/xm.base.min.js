(function(){var a=window.Xmeb||{};a={_INSTALL:function(){window.Xmeb=a;},Base:{},UI:{},App:{},Page:{}};a.Base={Verify:{TestRegExp:function(b,c){b=new RegExp(b);
return b.test(c);},IsEmpty:function(b){return typeof b!="string"?false:(b.trim()!=""?false:true);},IsTelephone:function(b){if(typeof b=="undefined"){return false;
}var c=/^(\((\d{2,5})\)|\d{2,5})?(\s*)(-?)(\s*)(\d{5,9})$/;return this.TestRegExp(c,b);},IsPhone:function(b){if(typeof b=="undefined"){return false;}var c=/^(\+86)?1[3,5,8](\d{9})$/;
return this.TestRegExp(c,b);},IsIdentityCode:function(b){if(typeof b=="undefined"){return false;}var c=/^[1-9](\d{5})(([1-9]\d)|([1,2](\d{3})))(0[1-9]|1[0,2])(0[1-9]|[1,2]\d|3[0,1])(\d{3})([0-9Xx]+)$/;
return this.TestRegExp(c,b);}}};a.UI={MousePosition:function(b){b=b||window.event;var d=b.pageX||b.clientX+document.body.scrollLeft,c=b.pageY||b.clientY+document.body.scrollTop;
return{positionX:d,positionY:c};},GetArea:function(c){if(c.selector=="document"){return{height:$(document).height(),width:$(document).width()};}if(c.css("overflow")!="hidden"){return{height:c.height(),width:c.width()};
}var b=c.clone();b.css({display:"block",position:"absolute",overflow:"visible"});return{height:b.height(),width:b.width()};},cookie:function(e,f,c){if(arguments.length>1&&String(f)!=="[object Object]"){c=jQuery.extend({},c);
if(f===null||f===undefined){c.expires=-1;}if(typeof c.expires==="number"){var h=c.expires,d=c.expires=new Date();d.setDate(d.getDate()+h);}f=String(f);
return(document.cookie=[encodeURIComponent(e),"=",c.raw?f:encodeURIComponent(f),c.expires?"; expires="+c.expires.toUTCString():"",c.path?"; path="+c.path:"",c.domain?"; domain="+c.domain:"",c.secure?"; secure":""].join(""));
}c=f||{};var b,g=c.raw?function(i){return i;}:decodeURIComponent;return(b=new RegExp("(?:^|; )"+encodeURIComponent(e)+"=([^;]*)").exec(document.cookie))?g(b[1]):null;
}};a.App={getBLength:function(b){return $.trim(b).replace(/[^\x00-\xff]/g,"**").length;},getWLength:function(b){return Math.ceil($.trim(b).replace(/[^\x00-\xff]/g,"**").length/2);
},lazyload:function(e){var d={defObj:null,defHeight:0};d=$.extend(d,e||{});var c=d.defHeight,h=(typeof d.defObj=="object")?d.defObj.find("img"):$(d.defObj).find("img");
var b=function(){var i=document,j=(navigator.userAgent.toLowerCase().match(/iPad/i)=="ipad")?window.pageYOffset:Math.max(i.documentElement.scrollTop,i.body.scrollTop);
if(navigator.userAgent.toLowerCase().match(/iPad/i)=="ipad"){d.defHeight=0;}return i.documentElement.clientHeight+j-d.defHeight;};var f=function(j){var i=j.attr("src2");
if(i){j.css({opacity:"0.3"}).attr("src",i).removeAttr("src2").animate({opacity:"1"});}};var g=function(){h.each(function(){if(navigator.userAgent.toLowerCase().match(/iPad/i)=="ipad"){f($(this));
}else{if($(this).offset().top<=b()){f($(this));}}});};g();$(window).bind("scroll",function(){g();});},miniIndexCart:{defaults:{num:parseInt(a.UI.cookie("xm_user_www_num")),noframeHTML:"<p class='header_miniCart_nogood'>购物车中还没有商品，赶紧选购吧！</p>"},showNum:function(){if(a.UI.cookie("xm_user_www_num")){if(a.UI.cookie("xm_user_www_num")=="0"){$(".header_miniCart_gocart").remove();
}else{$("#miniCartNum").html(this.defaults.num);}}},ini:function(){this.showNum();$(".header_menu_top_cart").hover(function(){$(this).addClass("header_hoverOn");
var b=parseInt($("#minicart").length);if(b==1){$("#header_miniCart").fadeIn("fast");}else{$("#header_miniCart").prepend("<iframe src='"+orderSiteTokenUnique+"/cart/mini' width='100%' height='100%' name='minicart' id='minicart' frameborder='0' scrolling='no'></iframe>").fadeIn("fast");
}},function(){$(this).removeClass("header_hoverOn");$("#header_miniCart").hide();});$(".header_menu_top_cart").click(function(){location.href=orderSiteTokenUnique+"/cart";
});}},addMinicart:function(c){var e={wrapObj:null,autoRemove:true,miniCartNum:"#miniCartNum",cookieNumname:"xm_user_www_num",miniFrameid:"#minicart",successHTML:"该商品已经加入购物车",autoSeconds:3000,gid:null,tipsname:"goodsDisplay_tips",indetailspage:false};
e=$.extend(e,c||{});var d=function(k,j){var h=e.wrapObj;var i=0;if(a.UI.cookie(e.cookieNumname)){i=parseInt(a.UI.cookie(e.cookieNumname));}if(k=="added"){$(e.miniCartNum).html(i);
$(e.miniFrameid).remove();if(!e.indetailspage){h.css({position:"relative"}).append('<p class="'+e.tipsname+'">'+e.successHTML+"</p>");}else{h.css({position:"relative"}).append('<div id="boxy_cart"><dl><dt class="cfl"><strong>该商品已经加入购物车</strong><a href="#"></a></dt><dd>购物车共'+i+'件商品</dd><dd class="boxy_cart_btn"><a href="'+orderSiteTokenUnique+'/cart" class="item1">去结算</a> <a href="/" class="item2">继续逛>></a></dd></dl></div>');
}}else{if(!e.indetailspage){h.css({position:"relative"}).append('<p class="'+e.tipsname+'">'+j+"</p>");}else{h.css({position:"relative"}).append('<div id="boxy_cart" style="height:72px;"><dl><dt class="cfl"><strong>'+j+'</strong><a href="#"></a></dt><dd>购物车共'+i+'件商品<a href="'+orderSiteTokenUnique+'/site/login" style="color:#ff6600;margin-left:10px;">立即登录</a></dd></dl></div>');
}}h.find("."+e.tipsname).fadeIn();if(e.autoRemove){setTimeout(function(){h.find("."+e.tipsname).remove();h.css({position:"static"});},e.autoSeconds);}};
var g=function(){var h=orderSiteTokenUnique+"/user/proxy",i="<iframe src='"+h+"' width='0' height='0' name='proxy' id='proxy' frameborder='0' scrolling='no'></iframe>";
$(document.body).append(i);$("iframe[name='proxy']").load(function(){alert("sdfsd");});};var f=function(i){var h=i.message;if(i.code==1){d("added");}else{d("unadd",h);
}};var b=function(){$.ajax({url:orderSiteTokenUnique+"/cart/add/"+e.gid,dataType:"jsonp",jsonp:"jsonpcallback",success:function(h){f(h);},Complete:function(){},error:function(){alert("系统繁忙，请重试");
}});};b();},loginNavigation:{data:{userId:0,userName:"",goodsNum:0},miid:a.UI.cookie("userId"),init:function(){this.data.userId=this.miid;if(!this.data.userId){return false;
}this.data.userName=(this.miid)?a.UI.cookie("XM_"+this.miid+"_UN"):"";this.data.goodsNum=a.UI.cookie("xm_user_www_num");this.data.goodsNum=(this.data.goodsNum==null)?0:this.data.goodsNum;
if(this.data.userName==null||this.data.userName==""){var b=document.createElement("script");b.src="https://account.xiaomi.com/pass/userInfoJsonP?userId="+this.miid+"&callback=Xmeb.App.loginNavigation.getAccountInfo";
b.type="text/javascript";b.async=true;document.getElementsByTagName("head")[0].appendChild(b);}else{this.upNavigationHtml();}},upNavigationHtml:function(){var b=' <span class="header_menu_top_login_user"><strong>'+this.data.userName+'</strong></span><a class="no_border" href="'+this.orderUrl+'">[ 退出 ]</a>';
var c=this;$("#header_menu_top_login").html(b);$("#header_menu_top_order").show();},getAccountInfo:function(c){if(c.userId){this.data.userName=(c.uniqName)?c.uniqName:c.userId;
var b={path:"/",domain:".xiaomi.com"};a.UI.cookie("XM_"+this.miid+"_UN",this.data.userName,b);this.upNavigationHtml();}}},xmFocus:{init:function(d,c){var e=this;
this._obj=d;this.mlength=this._obj.find("a").length;this.setOptions(c);this.mwidth=this.options.mwidth;this.mtime1=this.options.mtime1;this.mtime2=this.options.mtime2;
this.autoWidth=this.options.autoWidth;if(this.mlength!=1){this.ul=this._obj.find("ul");this.build(this.ul,this.mlength);var b=(parseInt(this._obj.find("li").eq(0).width())+8)*this.mlength;
this.ul.css({width:b});if(this.autoWidth){this.ul.css({right:"50%","margin-right":"-465px"});this._obj.find("a").css({display:"inline-block",width:"960",height:"430"});
}e.options.AllowAutoSlide=true;this._obj.find("a").mouseenter(function(){e.options.AllowAutoSlide=false;}).mouseleave(function(){e.options.AllowAutoSlide=true;
});this.ul.find("li").mouseenter(function(f){e.options.AllowAutoSlide=false;e.slideTo(this);}).mouseleave(function(){e.options.AllowAutoSlide=true;});setInterval(function(){if(e.options.AllowAutoSlide){e.slideDown();
}},e.mtime1);}this._obj.css({width:this.mwidth});},setOptions:function(b){this.options={mwidth:1024,mtime1:7000,mtime2:500,autoWidth:false,AllowAutoSlide:false};
for(var c in b){this.options[c]=b[c];}},build:function(d,c){this.tmp="";for(var b=0;b<c;b++){this.tmp+="<li index="+(c-b)+"></li>";}d.html(this.tmp);d.find("li").last().addClass("on");
this.ulWidth=d.width();},slideDown:function(){var d=this;var c=d.ul.find("li.on");if(c.length<=0){return;}var b=c.get(0).previousSibling;d.slideTo(b?b:d.ul.find("li").last());
},slideTo:function(f){var g=this;if(!f){return;}var b=g.ul.find("li.on").attr("index");if(this.autoWidth){var e=g._obj.find("div[index='"+b+"']");var c=g._obj.find("div[index='"+$(f).attr("index")+"']");
}else{var e=g._obj.find("a[index='"+b+"']");var c=g._obj.find("a[index='"+$(f).attr("index")+"']");}var d=function(){if(b==$(f).attr("index")){return;}g.ul.find("li.on").removeClass("on");
$(f).addClass("on");c.css("z-index",2);e.css("z-index",3).fadeOut(g.mtime2,function(){$(this).css("z-index","1").show();});};if(!g.options.AllowAutoSlide){setTimeout(function(){d();
},400);}else{d();}}}};a._INSTALL();})();